## 微信公共服务

### 公众号参数

```
app_id=wx1558a28a6907c3e8
app_secret=ebdb772d4b503378aabc5dac1d877015
callback_url=http://np5b8h.natappfree.cc/receive/wechat/callback
callback_url_token=guiji_wechat_token
encoding_aes_key=guijiHUizZiqnGAVEfqFYbYUstomVTo1eoL7iOZlfPP
```



### 发送模板消息

- 消息模板
```
   模板ID：sWm0PZIGJ0EZZ0gH3n7eeT__sC1mGxqqzhHkGXwzy_s
    
    {{first.DATA}}
    客户名称：{{keyword1.DATA}}
    客服类型：{{keyword2.DATA}}
    提醒内容：{{keyword3.DATA}}
    通知时间：{{keyword4.DATA}}
    {{remark.DATA}}
```

- 接口使用说明
```  
    使用说明：
    调用接口 :  WeChatApi  Result.ReturnData<String> send(@RequestBody SendMsgReqVO sendMsgReqVO);
    
    必填字段：
       openID "微信用户openID"
       templateId 模板ID
    示例：
        sendMsgReqVO.setOpenID("XXXXX");
        sendMsgReqVO.setTemplateId("sWm0PZIGJ0EZZ0gH3n7eeT__sC1mGxqqzhHkGXwzy_s");
    
    示例：设置消息文案主体
        sendMsgReqVO.addData("first", "你好！");
        sendMsgReqVO.addData("keyword1", "用户1");
        sendMsgReqVO.addData("keyword2", "A类意向客户");
        sendMsgReqVO.addData("keyword3", "您的外呼任务已完成哦！请登录系统查看外呼结果");
        sendMsgReqVO.addData("keyword4", "2019-01-30 15:52:10");
        sendMsgReqVO.addData("remark", "通知结束");
    用户收到消息：
        你好！
        客户名称：用户1
        客服类型：A类意向客户
        提醒内容：您的外呼任务已完成哦！请登录系统查看外呼结果
        通知时间：2019-01-30 15:52:10
        通知结束
        
    示例：设置页面跳转url
    sendMsgReqVO.setUrl("www.bing.com");
    
    
    示例：设置小程序(url和miniprogram都是非必填字段，若都不传则模板无跳转；若都传，会优先跳转至小程序。)
    appid	是	所需跳转到的小程序appid（该小程序appid必须与发模板消息的公众号是绑定关联关系，暂不支持小游戏）
    pagepath	否	所需跳转到小程序的具体页面路径，支持带参数,（示例index?foo=bar），暂不支持小游戏
            
            sendMsgReqVO.setAppId("XXXX");
            sendMsgReqVO.setPagePath("/path/page");
```

### 消息场景


```
    • 意向客户
        ◦ 触发条件：在拨打计划时，出现意向客户实时推送，意向客户时根据推送设置中设置的意向标签
        ◦ 站内信：
            ▪ 标题：A类意向客户
            ▪ 内容：客户号码：18512522222，点击查看详细通话记录，及时进行客户跟进
            ▪ 跳转：【通话记录】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：A类意向客户
            ▪ 推送内容：客户号码：18512522222，点击查看详细通话记录，及时进行客户跟进
            ▪ 跳转：小程序通话详情页面
    • 任务完成
        ◦ 触发条件：同一个账号同一时间加入计划的一批号码，拨打完成后实时触发消息通知
        ◦ 站内信：
            ▪ 标题：任务完成
            ▪ 内容：您在2019-01-30 15:52:10创建的100通号码的外呼任务已完成，请登录系统查看外呼结果。
            ▪ 跳转：【呼叫中心】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：任务完成
            ▪ 推送内容：您的外呼任务已完成哦！请登录系统查看外呼结果
            ▪ 跳转：小程序首页

    • 连续未接通警报
        ◦ 触发条件：单个账号批量加入计划，连续100个F类推送提醒；下次的连续未接通警报，应该除去本次已报警的F类拨打记录；
        ◦ 站内信：
            ▪ 标题：连续未接通警报
            ▪ 内容：您的外呼任务出现连续100通电话未接通，请点击查看
            ▪ 跳转：【通话记录】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：连续未接通警报
            ▪ 推送内容：您的外呼任务出现连续100通电话未接通，请点击查看
            ▪ 跳转：小程序首页

    • 线路报错
        ◦ 触发条件：单个线路，出现连续100通电话的W线路报错问题推送提醒
        ◦ 站内信：
            ▪ 标题：线路报错
            ▪ 内容：您的外呼任务出现连续100通电话线路报错的问题，请点击查看具体报错信息，并联系您的线路提供商
            ▪ 跳转：【通话记录】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：线路报错
            ▪ 推送内容：您的外呼任务出现连续100通电话线路报错的问题，请点击查看具体报错信息，并联系您的线路提供商
            ▪ 跳转：小程序首页
    • 公告
        ◦ 触发条件：新增公告：“升级通知、服务通知”推送提醒
        ◦ 站内信：
            ▪ 标题：公告标题
            ▪ 内容：公告内容前50个文字，登录系统查看详情
            ▪ 跳转：【公告列表】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：公告标题
            ▪ 推送内容：公告内容前50个文字，登录系统查看详情

    • 余额不足
        ◦ 触发条件：账户的余额不足用户设置的阈值时，实时推送提醒一次。当天提醒1次，第二天之后每日推送一次。
        ◦ 站内信：
            ▪ 标题：余额不足
            ▪ 内容：尊敬的XXX，您的账户余额已不足￥XXX，为了不影响您的外呼任务，请及时充值。详情请登录后台费用中心进行查看，感谢您的使用。
            ▪ 跳转：【财务中心】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：余额不足
            ▪ 推送内容：尊敬的XXX，您的账户余额已不足￥XXX，为了不影响您的外呼任务，请及时充值。详情请登录后台费用中心进行查看，感谢您的使用。
        ◦ 短信：
            ▪ 【硅基智能】尊敬的XXX，您的账户余额已不足￥XXX，为了不影响您的外呼任务，请及时充值。详情请登录后台费用中心进行查看，感谢您的使用。

    • 充值到账
        ◦ 触发条件：管理员为客户充值完成时，推送提醒
        ◦ 站内信
            ▪ 标题：充值到账
            ▪ 内容：尊敬的XXX，您的充值已成功，您的账户当前余额￥XXX。
            ▪ 跳转：【财务中心】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：充值到账
            ▪ 推送内容：尊敬的XXX，您的充值已成功，您的账户当前余额￥XXX。
        ◦ 短信：
            ▪ 【硅基智能】尊敬的XXX，您的充值已成功，您的账户当前余额￥XXX。

    • 账户到期
        ◦ 触发条件：以账户有效期为基准，提前7天提醒客户。
        ◦ 站内信
            ▪ 标题：账户到期预警
            ▪ 内容：尊敬的XXX，您的账户即将到期，请联系您的销售经理进行延期。
            ▪ 跳转：【个人中心】页面
        ◦ 微信：
            ▪ 客户名称：yangyang
            ▪ 消息类型：账户到期
            ▪ 推送内容：尊敬的XXX，您的账户即将到期，请联系您的销售经理进行延期。
        ◦ 短信：
            ▪ 【硅基智能】尊敬的XXX，您的账户即将到期，请联系您的销售经理进行延期。
    • 
```
            
            